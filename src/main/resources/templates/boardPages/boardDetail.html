<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <th:block th:replace="component/config :: config"></th:block>
</head>
<body>
<div id="section">
    <div class="container" id="board-detail">
        <table class="table table-striped table-hover text-center">
            <tr>
                <th>id</th>
                <td th:text="${board.id}"></td>
            </tr>
            <tr>
                <th>title</th>
                <td th:text="${board.boardTitle}"></td>
            </tr>
            <tr>
                <th>writer</th>
                <td th:text="${board.boardWriter}"></td>
            </tr>
            <tr>
                <th>password</th>
                <td th:text="${board.boardPass}"></td>
            </tr>
            <tr>
                <th>date</th>
                <td th:text="${board.createdAt}"></td>
            </tr>
            <tr>
                <th>hits</th>
                <td th:text="${board.boardHits}"></td>
            </tr>
        </table>
        <div class="container">
            <button class="btn btn-primary" onclick="list_req()">목록</button>
<!--            <button class="btn btn-warning" onclick="update_req()">수정</button>-->
            <button class="btn btn-warning" onclick="req('update')">수정</button>
<!--            <button class="btn btn-danger" onclick="delete_req()">삭제</button>-->
            <button class="btn btn-warning" onclick="req('delete')">삭제</button>
        </div>
    </div>
    <div id="pass-check">
<!--        <input type="text" placeholder="password" id="password">-->
<!--        <button onclick="pass_check()">확인</button>-->
    </div>
</div>
<div th:replace="component/footer :: footer"></div>
</body>
<script th:inline="javascript">
    const list_req = () => {
        location.href = "/board/";
    }

    // const update_req = () => {
    //     document.getElementById("pass-check").innerHTML = "<input type=\"text\" placeholder=\"password\" id=\"password\">\n" +
    //         "        <button onclick=\"update_pass_check()\">확인</button>"
    // }
    //
    // const delete_req = () => {
    //     document.getElementById("pass-check").innerHTML = "<input type=\"text\" placeholder=\"password\" id=\"password\">\n" +
    //         "        <button onclick=\"delete_pass_check()\">확인</button>"
    // }

    const req = (type) => {
        console.log("type", type);
        document.getElementById("pass-check").innerHTML = "<input type=\"text\" placeholder=\"password\" id=\"password\">\n" +
            "        <button onclick=\"pass_check('" + type + "')\">확인</button>";
    }

    const pass_check = (type) => {
        console.log("pass_check type 변수 값", type);
        const password = document.getElementById("password").value;
        const passDB = [[${board.boardPass}]];
        const id = [[${board.id}]];
        if(password == passDB) {
            if(type == "update") {
                location.href = "/board/update/" + id;
            } else if(type == "delete") {
                // location.href = "board/delete/" + id;
                axios({
                    method: "delete",
                    url: "/board/"+id
                }).then(res => {
                    location.href = "/board/";
                }).catch(err => {
                    alert("삭제 실패!!");
                });
            }
        } else {
            alert("비밀번호가 일치하지 않습니다.");
        }
    }

    const update_pass_check = () => {
        const password = document.getElementById("password").value;
        const passDB = [[${board.boardPass}]];
        const id = [[${board.id}]];
        if(password == passDB) {
            location.href = "/board/update/" + id;
        } else {
            alert("비밀번호가 일치하지 않습니다.");
        }
    }

    const delete_pass_check = () => {
        const password = document.getElementById("password").value;
        const passDB = [[${board.boardPass}]];
        const id = [[${board.id}]];
        if(password == passDB) {
            // location.href = "/board/delete/" + id;
            axios({
                method: "delete",
                url: "/board/"+id
            }).then(res => {
                location.href = "/board/";
            }).catch(err => {
                alert("삭제 실패!!");
            });
        } else {
            alert("비밀번호가 일치하지 않습니다.");
        }
    }
</script>
</html>